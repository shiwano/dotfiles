# è£œå®Œæ©Ÿèƒ½æœ‰åŠ¹
autoload -U compinit
compinit

# æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®è¨­å®š
export LANG=ja_JP.UTF-8

# ãƒ‘ã‚¹ã®è¨­å®š
PATH=~/bin:/usr/local/bin:$PATH
export MANPATH=/usr/local/share/man:/usr/local/man:/usr/share/man
[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm" # This loads RVM into a shell session.

#vim
if [ -d /Applications/MacVim.app ]; then
  export EDITOR=/Applications/MacVim.app/Contents/MacOS/Vim
  alias vi='env LANG=ja_JP.UTF-8 /Applications/MacVim.app/Contents/MacOS/Vim "$@"'
  alias vim='env LANG=ja_JP.UTF-8 /Applications/MacVim.app/Contents/MacOS/Vim "$@"'
fi

# é–¢æ•°
find-grep () { find . -type f -print | xargs grep -n --binary-files=without-match $@ }

# vié¢¨ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰
bindkey -v

# ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®è¨­å®š
alias ls='ls --color=auto'
alias ll='ls -l'
alias la='ls -A'
alias lal="ls -l -A"
alias vi='vim'
alias g='git'
alias s='git status'
alias server='ruby ~/dotfiles/tools/server.rb'

# brew ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸctags
if [ -d /usr/local/Cellar/ctags ]; then
  alias ctags="`brew --prefix`/bin/ctags"
fi

# brew ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸ256è‰²å¯¾å¿œscreen
if [ -d /usr/local/Cellar/screen ]; then
  alias screen="`brew --prefix`/bin/screen"
fi

# zmv
autoload zmv
alias zmv='noglob zmv -W'
alias zcp='noglob zmv -C'
alias zln='noglob zmv -L'
alias zsy='noglob zmv -Ls'

# Extract
extract () {
  if [ -f $1 ] ; then
    case $1 in
      *.tar.bz2)   tar xvjf $1    ;;
      *.tar.gz)    tar xvzf $1    ;;
      *.tar.xz)    tar xvJf $1    ;;
      *.bz2)       bunzip2 $1     ;;
      *.rar)       unrar x $1     ;;
      *.gz)        gunzip $1      ;;
      *.tar)       tar xvf $1     ;;
      *.tbz2)      tar xvjf $1    ;;
      *.tgz)       tar xvzf $1    ;;
      *.zip)       unzip $1       ;;
      *.Z)         uncompress $1  ;;
      *.7z)        7z x $1        ;;
      *.lzma)      lzma -dv $1    ;;
      *.xz)        xz -dv $1      ;;
      *)           echo "don't know how to extract '$1'..." ;;
    esac
  else
    echo "'$1' is not a valid file!"
  fi
}
alias ex='extract'

# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®è¨­å®š
autoload -Uz vcs_info
zstyle ':vcs_info:*' formats '[%b]'
zstyle ':vcs_info:*' actionformats '[%b|%a]'
precmd () {
    psvar=()
    LANG=en_US.UTF-8 vcs_info
    [[ -n "$vcs_info_msg_0_" ]] && psvar[1]="$vcs_info_msg_0_"
}

case ${UID} in
0)
    PROMPT="%B%{[31m%}%/#%{[m%}%b "
    PROMPT2="%B%{[31m%}%_#%{[m%}%b "
    SPROMPT="%B%{[31m%}%r is correct? [n,y,a,e]:%{[m%}%b "
    [ -n "${REMOTEHOST}${SSH_CONNECTION}" ] && 
        PROMPT="%{[37m%}${HOST%%.*} ${PROMPT}"
    ;;
*)
    PROMPT="%{[31m%}%/%%%{[m%} "
    PROMPT2="%{[31m%}%_%%%{[m%} "
    SPROMPT="%{[31m%}%r is correct? [n,y,a,e]:%{[m%} "
    [ -n "${REMOTEHOST}${SSH_CONNECTION}" ] && 
        PROMPT="%{[37m%}${HOST%%.*} ${PROMPT}"
    ;;
esac
RPROMPT="%1(v|%F{green}%1v%f|)"

# è£œå®Œè¨­å®š
HISTFILE=~/.zsh_history
HISTSIZE=100000
SAVEHIST=100000

# ã‚·ã‚§ãƒ«ã®ãƒ—ãƒ­ã‚»ã‚¹ã”ã¨ã«å±¥æ­´ã‚’å…±æœ‰
setopt share_history

# ä½™åˆ†ãªã‚¹ãƒšãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¦ãƒ’ã‚¹ãƒˆãƒªã«è¨˜éŒ²ã™ã‚‹
setopt hist_reduce_blanks

# ãƒ’ã‚¹ãƒˆãƒªã«historyã‚³ãƒãƒ³ãƒ‰ã‚’è¨˜éŒ²ã—ãªã„
setopt hist_no_store

# ãƒ’ã‚¹ãƒˆãƒªã‚’å‘¼ã³å‡ºã—ã¦ã‹ã‚‰å®Ÿè¡Œã™ã‚‹é–“ã«ä¸€æ—¦ç·¨é›†ã§ãã‚‹çŠ¶æ…‹ã«ãªã‚‹
setopt hist_verify

# è¡Œé ­ãŒã‚¹ãƒšãƒ¼ã‚¹ã§å§‹ã¾ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ãƒ’ã‚¹ãƒˆãƒªã«è¨˜éŒ²ã—ãªã„
#setopt hist_ignore_spece

# ç›´å‰ã¨åŒã˜ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ãƒ’ã‚¹ãƒˆãƒªã«è¿½åŠ ã—ãªã„
setopt hist_ignore_dups

# é‡è¤‡ã—ãŸãƒ’ã‚¹ãƒˆãƒªã¯è¿½åŠ ã—ãªã„
setopt hist_ignore_all_dups

# è£œå®Œã™ã‚‹ã‹ã®è³ªå•ã¯ç”»é¢ã‚’è¶…ãˆã‚‹æ™‚ã«ã®ã¿ã«è¡Œã†ï½¡
LISTMAX=0

# sudo ã§ã‚‚è£œå®Œã®å¯¾è±¡
zstyle ':completion:*:sudo:*' command-path /usr/local/sbin /usr/local/bin /usr/sbin /usr/bin /sbin /bin

# cdã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§è‡ªå‹•çš„ã«pushd
setopt auto_pushd

# check correct command
#setopt correct

# è¤‡æ•°ã® zsh ã‚’åŒæ™‚ã«ä½¿ã†æ™‚ãªã© history ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¸Šæ›¸ãã›ãšè¿½åŠ 
setopt append_history

# è£œå®Œå€™è£œãŒè¤‡æ•°ã‚ã‚‹æ™‚ã«ã€ä¸€è¦§è¡¨ç¤º
setopt auto_list

# auto_list ã®è£œå®Œå€™è£œä¸€è¦§ã§ã€ls -F ã®ã‚ˆã†ã«ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®åˆ¥ã‚’ãƒãƒ¼ã‚¯è¡¨ç¤ºã—ãªã„
setopt no_list_types

# ä¿ç®¡çµæœã‚’ã§ãã‚‹ã ã‘è©°ã‚ã‚‹
setopt list_packed

# è£œå®Œã‚­ãƒ¼ï¼ˆTab, Ctrl+I) ã‚’é€£æ‰“ã™ã‚‹ã ã‘ã§é †ã«è£œå®Œå€™è£œã‚’è‡ªå‹•ã§è£œå®Œ
setopt auto_menu

# ã‚«ãƒƒã‚³ã®å¯¾å¿œãªã©ã‚’è‡ªå‹•çš„ã«è£œå®Œ
setopt auto_param_keys

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã®è£œå®Œã§æœ«å°¾ã® / ã‚’è‡ªå‹•çš„ã«ä»˜åŠ ã—ã€æ¬¡ã®è£œå®Œã«å‚™ãˆã‚‹
setopt auto_param_slash

# ãƒ“ãƒ¼ãƒ—éŸ³ã‚’é³´ã‚‰ã•ãªã„ã‚ˆã†ã«ã™ã‚‹
setopt no_beep

# ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®å¼•æ•°ã§ --prefix=/usr ãªã©ã® = ä»¥é™ã§ã‚‚è£œå®Œã§ãã‚‹
setopt magic_equal_subst

# ãƒ•ã‚¡ã‚¤ãƒ«åã®å±•é–‹ã§ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒãƒƒãƒã—ãŸå ´åˆæœ«å°¾ã« / ã‚’ä»˜åŠ ã™ã‚‹
setopt mark_dirs

# 8 ãƒ“ãƒƒãƒˆç›®ã‚’é€šã™ã‚ˆã†ã«ãªã‚Šã€æ—¥æœ¬èªã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’è¡¨ç¤ºå¯èƒ½
setopt print_eight_bit

# Ctrl+wã§ï½¤ç›´å‰ã®/ã¾ã§ã‚’å‰Šé™¤ã™ã‚‹ï½¡
WORDCHARS='*?_-.[]~=&;!#$%^(){}<>'

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ°´è‰²ã«ã™ã‚‹ï½¡
export LS_COLORS='di=01;36'

# ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆè£œå®Œã§ã‚‚lsã¨åŒæ§˜ã«è‰²ã‚’ã¤ã‘ã‚‹ï½¡
zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}

# cd ã‚’ã—ãŸã¨ãã«lsã‚’å®Ÿè¡Œã™ã‚‹
function chpwd() { ls }

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã ã‘ã§ï½¤ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç§»å‹•ã‚’ã™ã‚‹ï½¡
setopt auto_cd

# C-s, C-qã‚’ç„¡åŠ¹ã«ã™ã‚‹ã€‚
setopt no_flow_control

# C-p C-n ã§ã‚³ãƒãƒ³ãƒ‰å±¥æ­´æ¤œç´¢
autoload history-search-end
zle -N history-beginning-search-backward-end history-search-end
zle -N history-beginning-search-forward-end history-search-end
bindkey "^P" history-beginning-search-backward-end
bindkey "^N" history-beginning-search-forward-end
