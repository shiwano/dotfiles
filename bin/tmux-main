#!/usr/bin/env bash

set -euo pipefail

usage() {
	local fd="${1:-2}"
	cat <<EOF >&"$fd"
Usage: tmux-main

Attach to the 'main' tmux session, or create it if it doesn't exist.

Examples:
  tmux-main
EOF
}

main() {
	if [[ "${1:-}" == "--help" || "${1:-}" == "-h" ]]; then
		usage 1
		return 0
	fi

	if ! command -v tmux >/dev/null 2>&1; then
		echo "Error: tmux is not installed" >&2
		return 1
	fi

	if [ -n "${TMUX:-}" ]; then
		echo "Error: already inside a tmux session" >&2
		return 1
	fi

	tmux new-session -A -s main
}

main "$@"
