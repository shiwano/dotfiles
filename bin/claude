#!/bin/bash

set -euo pipefail

main() {
	exec mise exec -- cage \
		-allow . \
		-allow "$HOME/dotfiles/dot.config/claude" \
		-allow "$HOME/.config/claude" \
		-allow "$HOME/.mcp-global.json" \
		-allow "$HOME/.npm" \
		-allow "$HOME/.npmrc" \
		-allow "$HOME/.pub-cache" \
		-allow "$HOME/.cargo" \
		-allow "$HOME/.rustup" \
		-allow "$HOME/.gem" \
		-allow "$HOME/.bundle" \
		-allow "$HOME/.local" \
		-allow "$HOME/.cache" \
		-allow "$HOME/Library/Caches" \
		-allow "$HOME/Library/Logs" \
		-allow "$GOPATH/pkg" \
		-allow "$HOMEBREW_PREFIX/Library/Homebrew/cmd/shellenv.sh" \
		-allow "/dev/tty" \
		-allow "/tmp" \
		-allow "/private/tmp" \
		-allow "$(git rev-parse --git-common-dir)" \
		-allow-keychain \
		claude --mcp-config "$HOME/.mcp-global.json" "$@"
}

main "$@"
