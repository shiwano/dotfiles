#!/usr/bin/env bash

set -euo pipefail

usage() {
	local fd="${1:-2}"
	cat <<EOF >&"$fd"
Usage: docker-run-sh <image> [args...]

Run a Docker container with sh as the entrypoint.

Examples:
  docker-run-sh alpine
  docker-run-sh ubuntu:22.04
  docker-run-sh nginx --rm
EOF
}

main() {
	if [[ "${1:-}" == "--help" || "${1:-}" == "-h" ]]; then
		usage 1
		return 0
	fi

	if ! command -v docker >/dev/null 2>&1; then
		echo "Error: docker is not installed" >&2
		return 1
	fi

	if [ "$#" -lt 1 ]; then
		usage
		return 1
	fi

	docker run -it --entrypoint sh "$@"
}

main "$@"
